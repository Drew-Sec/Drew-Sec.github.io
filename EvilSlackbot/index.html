<!DOCTYPE html>
<html>
<head>
<title>EvilSlackbot: A Slack Attack Framework</title>
<meta charset="UTF-8">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="EvilSlackbot: A Slack Attack Framework"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<style>
body,h1,h2,h3,h4,h5 {font-family: "Raleway", sans-serif}
</style>
</head>
<body class="w3-light-grey">

<!-- w3-content defines a container for fixed size centered content, 
and is wrapped around the whole page content, except for the footer in this example -->
<div class="w3-content" style="max-width:1400px">

<!-- Header -->
<header class="w3-container w3-left w3-padding-32">
  <b> 
  <h1><b><u>EvilSlackbot: A Slack Attack Framework</u></b></h1>
  <p></p>
 
</header>
<!-- Introduction menu -->
<div class="w3-row-padding" style="margin:0 -16px">
  <div class="w3-half">
    <div class="w3-card-4 w3-margin w3-white">
      <div class="w3-container">
        <img src="images/frank.png" style="width:100%">
      <div class="w3-container w3-white" >
        <h4><b>DrewSec</b></h4>
        <p style="font-size: 18px">Twitter: <a style="color:#0000EE" href="https://mobile.twitter.com/infosec_drewze">@infosec_Drewze</a>
        <p style="font-size: 18px">Github: <a style="color:#0000EE" href="https://github.com/Drew-Sec">Drew-Sec</a></p>
      </div></div></div></div>
  <div class="w3-third">
    <div class="w3-card-4 w3-margin w3-white">
      <div class="w3-container" >
        <p style="font-size: 20px"><b><u>Table of Contents:</b></u></p>
        <ol><span style="font-size:18px">
        <li>
        <a style="color:#0000EE" href="#background">Background</a>
        </li>
        <li>
        <a style="color:#0000EE" href="#install">Installation</a>
        </li>
        <li>
        <a style="color:#0000EE" href="#usage">Usage</a>
        </li>
        <li>
        <a style="color:#0000EE" href="#token">Token Flag</a>
        </li>
        <li>
        <a style="color:#0000EE" href="#attacks">Attacks</a>
        </li>
        <li>
        <a style="color:#0000EE" href="#args">Arguements</a>
        </li>
        <li>
        <a style="color:#0000EE" href="#spoof">Spoofed Phishing Message</a>
        </li>
        <li>
        <a style="color:#0000EE" href="#message">Phishing Message</a>
        </li>
        <li>
        <a style="color:#0000EE" href="#attach">Malicious Attachment</a>
        </li>
         <li>
        <a style="color:#0000EE" href="#channel">List Public Channels</a>
        </li>
        <li>
        <a style="color:#0000EE" href="#search">Keyword Search for Leaked Secrets</a>
        </li>
        </span>
        </ol>
        </div></div>
  </div>
</div>
<!-- Blog entries -->
<div class="w3-col l8 s12" style="width:1600px">
  <!-- Blog entry -->
  <div class="w3-card-4 w3-margin w3-white">
    <div class="w3-container">
      <h2>Phishing with <span class="w3-tag"><em>EvilSlackbot</em></span></h2>
      <h5>By DrewSec, <span class="w3-opacity">Dec 3, 2023</span></h5>
    </div>

    <div class="w3-container">
      <img src="images/logo.png" style="width:20%">
      <p style="font-size: 24px"><strong>Github Project Link:</strong> <a style="color: #0000EE" href="https://github.com/Drew-Sec/EvilSlackbot">EvilSlackbot</a></p>
      <h6 style="font-size: 24px"><b><u>Disclaimer</u></b></h6>
      <p style="font-size: 18px"><b>The following information is for <b><u>educational purposes only.</u></b> This post is intended for Security Professionals looking to secure their orginizations. <u>DO NOT</u> use any of the following techniques maliciously or without the explicit permission of all those involved.</b></p>  
      <h6 id="background" style="font-size: 24px"><b><u>Background</u></b></h6>
      <p style="font-size: 18px">Thousands of organizations utilize Slack to help their employees communicate, collaborate, and interact. Many of these Slack workspaces install apps or bots that can be used to automate different tasks within Slack. These bots are individually provided permissions that dictate what tasks the bot is permitted to request via the Slack API. To authenticate to the Slack API, each bot is assigned an api token that begins with <u>xoxb or xoxp</u>. More often than not, these tokens are leaked somewhere. When these tokens are exfiltrated during a Red Team exercise, it can be a pain to properly utilize them. Now <em>EvilSlackbot</em> is here to automate and streamline that process. You can use <em>EvilSlackbot</em> to send <u> spoofed Slack messages, phishing links, files, and search for secrets leaked in slack.</u><br></br>In addition to red teaming, <em>EvilSlackbot</em> has also been developed with Slack phishing simulations in mind. To use <em>EvilSlackbot</em> to conduct a Slack phishing exercise, simply create a bot within Slack, give your bot the permissions required for your intended test, and provide <em>EvilSlackbot</em> with a list of emails of employees you would like to test with simulated phishes (Links, files, spoofed messages)</p>
    </div>
  </div>
<div class="w3-card-4 w3-margin w3-white">  
  <div class="w3-container">
      <h6 id="walkthrough" style="font-size: 26px"><b><u>Walkthrough</u></b></h6>
      <p id="install" style="font-size:20px"><u>Installation:</u></p>
      <p style="font-size: 18px"> <em>EvilSlackbot</em> requires both Python3 and Slackclient to run properly. To obtain Slackclient, you can simply install it using pip3.</p>
      <img src="images/install.png" style="width:40%">
      <p id="usage" style="font-size:20px"><u>Usage:</u></p>
      <img src="images/help.png" style="width:50%">
      <p id="token"style="font-size:20px"><u>Token:</u></p>
      <p style="font-size: 18px"> To use <em>EvilSlackbot</em> you will need an <b>xoxb or xoxp</b> token to authenticate to Slack's API. This is the <u>only required</u> flag when running <em>EvilSlackbot</em>. </p>
      <img src="images/token.png" style="width:30%">
      <p style="font-size: 18px"> One problem with xoxb tokens is that they are often exfiltrated during an engagement, but it is a pain to figure out what permissions are associated with them and what the token can be used to accomplish. <em>EvilSlackbot</em> will automatically take the token you provide it and display not only what permissions are associated with it, but also what attacks these permissions allow you to execute with <em>Evilslackbot</em>.<b> If your token does not possess all of the required permissions to execute a given attack, then you will not see that attack listed when you run <em>EvilSlackbot</em></b>. To simply check the permissions and attacks available for your token, provide <em>EvilSlackbot</em> with your token and utilize the <u>-c/--check flag</u></p>
      <img src="images/check.png" style="width:60%">
      <br></br>
      <h6 id="attacks"style="font-size: 24px"><b><u>Attacks</b></u></h6>
      <p style="font-size: 18px">List of attacks that can be executed with <em>EvilSlackbot</em></p>
      <img src="images/attacks.png" style="width:60%"></p>
      <p id="args" style="font-size: 18px">List of arguments to accompany your attacks</p>
      <img src="images/args.png" style="width:60%"></p>
      <br></br>
      <h6 id="spoof"style="font-size: 24px"><b><u>Spoofed Messages (-sP)</b></u></h6>
      <p style="font-size: 18px">With the correct token permissions, EvilSlackbot allows you to send phishing messages while impersonating the botname and bot photo. This attack also requires either <b>the email address (-e) of the target, a list of target emails (-eL), or the name of a Slack channel (-cH)</b>. EvilSlackbot will use these arguments to lookup the SlackID of the user associated with the provided emails or channel name. <b>To automate your attack, use a list of emails.</b></p>
      <img src="images/spoof.png" style="width:40%">
      <p style="font-size: 22px"><u>Example:</u></p>
      <p style="font-size: 18px">As an example, we'll take a look at using the Spoof message option to send a malicious link to a list of emails that are associated with users inside the bot's Slack workspace. We will have the ability to choose our sending bots name and profile image, allowing us to impersonate any bot we'd like or create a completely new bot that does not actually exist.</p>
      <img src="images/spoof1.png" style="width:70%">
      <p style="font-size: 18px">Next, we'll fill out all the requested input, providing a name for our evil bot, a url to an image hosted on the web, and a message containing our malicious link. Note that our message contains a hypertext link that obfuscates our actual link.</p>
      <img src="images/spoof2.png" style="width:70%">
      <p style="font-size: 18px"> <em>EvilSlackbot</em> will then display what we've selected and ask if we're ready to send our message. By typing "yes", our message will automatically be sent to every slack user on the email list we provided. If the email address provided does not have a Slack user associated with it in the workspace, <em>EvilSlackbot</em> will ignore it and continue down the list.</p>
      <img src="images/spoof3.png" style="width:70%">
      <p style="font-size: 18px"> Now we can go to our test Slack workspace and see that our spoofed slack message has been received</p>
      <img src="images/spoof4.png" style="width:60%">
      <br></br>
      <h6 id="message" style="font-size: 24px"><b><u>Phishing Messages (-m)</b></u></h6> 
      <p style="font-size: 18px"> 
      With the correct token permissions, <em>EvilSlackbot</em> allows you to send phishing messages containing phishing links. What makes this attack different from the Spoofed attack is that this method will send the message as the bot associated with your provided token. You will not be able to choose the name or image of the bot sending your phish. This attack also requires either <b><u>the email address (-e) of the target, a list of target emails (-eL), or the name of a Slack channel (-cH)</u></b>. <em>EvilSlackbot</em> will use these arguments to lookup the SlackID of the user associated with the provided emails or channel name. <b>To automate your attack, use a list of emails</b>.</p>
      <img src="images/messages.png" style="width:40%">
      <p style="font-size: 22px"><u>Example:</u></p>
      <p style="font-size: 18px">As an example, we'll send a phishing message containing  a malicious link to a single email address.</p>
      <img src="images/message.png" style="width:80%">
      <p style="font-size: 18px">Unlike the spoofed message attack, we will only be able to choose the message containing our malicious link. The actual bot associated with our token will deliver our message. In this example, the xoxb token belongs to calendarbot, a bot that this Slack workspace usually uses to send meeting reminders. We will send a message as this bot and include a hypertext link to our malicious site.</p>
      <img src="images/message1.png" style="width:80%">
      <p style="font-size: 18px">After reviewing our input, we'll type yes to send our phishing message to the Slack user associated with the email address we provided.</p>
      <img src="images/message2.png" style="width:80%"> 
      <p style="font-size: 18px"> Now we can go to our test Slack workspace and see that our slack phishing message has been received</p>
      <img src="images/message3.png" style="width:50%">
      <br></br>
      <h6 id="attach"style="font-size: 24px"><b><u>Attachments (-a)</b></u></h6>
      <p style="font-size: 18px">
      With the correct token permissions, <em>EvilSlackbot</em> allows you to send file attachments.<b> The attachment attack <u>requires a path to the file (-f)</u> you wish to send.</u></b> <b>This attack also requires either the <u>email address (-e) of the target, a list of target emails (-eL), or the name of a Slack channel (-cH).</u></b> <em>EvilSlackbot</em> will use these arguments to lookup the SlackID of the user associated with the provided emails or channel name. To automate your attack, use a list of emails.</p>
      <img src="images/attach.png" style="width:50%">
      <p style="font-size: 22px"><u>Example:</u></p>
      <p style="font-size: 18px"> As an example, we'll send a malicious attachment to a public Slack Channel. In this example, the xoxb token belongs to SecurityBot, a bot that this Slack workspace usually uses to send security information. We will send a message as this bot and include a malicious file attachment. Note that we did not include the # in the channel name</p>
      <img src="images/attach1.png" style="width:80%">
      <p style="font-size: 18px">We will now craft our malicious message that will be sent by the SecurityBot and name our malicious attachment.</p>
      <img src="images/attach2.png" style="width:80%">
      <p style="font-size: 18px">Next, we'll review our message and type 'yes' to send our malicious attachment to the designated Slack channel.</p> 
      <img src="images/attach3.png" style="width:80%">
      <p style="font-size: 18px"> Now we can go to our test Slack workspace and see that our malicious attachment has been received in the General channel</p>
      <img src="images/attach4.png" style="width:60%"><br></br>
      <h6 id="channel"style="font-size: 24px"><b><u>Channel List (-cL)</b></u></h6>
      <p style="font-size: 18px"> With the correct permissions, <em>EvilSlackbot</em> can search for and list all of the public channels within the Slack workspace. This can help with planning where to send channel messages. Use -o to write the list to an outfile.</p>
      <img src="images/channel.png" style="width:40%">
      <p style="font-size: 22px"><u>Example:</u></p>
      <p style="font-size: 18px"> Running the channel list command and writing the results to an outfile </p>
      <img src="images/channel1.png" style="width:60%">
      <br></br>
      <img src="images/channel2.png" style="width:20%"><br></br>
      <h6 id="search"style="font-size: 24px"><b><u>Secret Search (-s)</b></u></h6>
      <p style="font-size: 18px">With the correct token permissions, <em>EvilSlackbot</em> allows you to search Slack for secrets via a keyword search. Right now, <u>this attack requires a xoxp token</u>, as xoxb tokens can not be given the proper permissions to keyword search within Slack. Use the -o argument to write the search results to an outfile.</p>
      <img src="images/search.png" style="width:40%">
      <p style="font-size: 22px"><u>Example:</u></p>
      <p style="font-size: 18px"> Using the -s flag and a <u>xoxp token</u>, we start our secrets search. Note that the token permissions check shows that this token has less permissions and can only conduct the search attack.</p>
      <img src="images/search1.png" style="width:70%">
      <p style="font-size: 18px">We search for the keyword "password" and <em>EvilSlackbot</em> prints the results to the terminal. Remember that -o can be used to write the results to an out file.</p>
      <img src="images/search2.png" style="width:40%"><br></br>
    </b>  
    </div>
  </div>
  
  </div>

</body>
</html>
